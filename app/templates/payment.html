{% extends 'layout/base.html' %}
{% block title %}Thanh toán{% endblock %}
<body>
{% block content %}
{% if receipt %}
<h3 class="text-center mb-3">HÓA ĐƠN SỬA CHỮA</h3>
<form>
    <p><strong>Hóa đơn #:</strong> {{ receipt.id }}</p>
    <p><strong>Ngày:</strong> {{ receipt.created_date.strftime('%d/%m/%Y') }}</p>

    <hr>

    {% for rf in receipt.repair_forms %}
    <h5>Phiếu sửa #{{ rf.id }}</h5>

    <p>
        <strong>Khách :</strong> {{ rf.reception_form.name }} <br>
        <strong>SĐT :</strong> {{ rf.reception_form.phonenumber }} <br>
        <strong>Biển số :</strong> {{ rf.reception_form.carnumber }} <br>
        <strong>KTV :</strong> {{ rf.technick.name }}<br>
        <strong>Lỗi :</strong> {{ rf.reception_form.description }}
    </p>

    <table class="table table-bordered table-sm">
        <thead class="table-light">
        <tr>
            <th>Hạng mục</th>
            <th>Tiền công</th>
            <th>Linh kiện</th>
            <th>Đơn giá</th>
            <th class="text-center">SL</th>
            <th class="text-end">Thành tiền</th>
        </tr>
        </thead>
        <tbody>
        {% for c in rf.components %}
        <tr>
            <td>{{ c.action }}</td>
            <td>{{ c.cost }}</td>
            <td>{{ c.component.name }}</td>
            <td>{{ c.component.price }}</td>
            <td class="text-center">{{ c.quantity }}</td>
            <td class="text-end">
                {{ (c.component.price * c.quantity) }}
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    <hr>
    {% endfor %}

    <h4 class="text-end">
        TỔNG THANH TOÁN ({{vat.VAT}}%) :
        {{ (receipt.total_cost) }}
    </h4>

</form>

<form method="post"
      action="{{ url_for('payments_bp.index') }}"
      class="text-center mt-4">
    <button class="btn btn-success btn-lg">
        Xác nhận thanh toán
    </button>
</form>
<br>
<br>
{% else %}
    <tr>
        <td colspan="7" class="text-center ">
            <div class="d-flex flex-column align-items-center gap-2 py-5">
                <i class="fa fa-inbox fa-4x text-secondary opacity-50 py-2"></i>

                <h5 class="fw-semibold text-secondary mb-0 py-2">
                    Không có hóa đơn để thanh toán
                </h5>

                <p class="text-muted mb-0 py-2">
                    Chưa có dữ liệu để hiển thị
                </p>
            </div>
        </td>
    </tr>

{% endif %}
{% endblock%}
</body>